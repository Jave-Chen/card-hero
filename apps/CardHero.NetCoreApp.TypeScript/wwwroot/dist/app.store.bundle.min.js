(window["wj"] = window["wj"] || []).push([[7],{

/***/ "gNsK":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);

// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__("q1tI");
var react_default = /*#__PURE__*/__webpack_require__.n(react);

// EXTERNAL MODULE: ./node_modules/react-dom/index.js
var react_dom = __webpack_require__("i8i4");
var react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);

// EXTERNAL MODULE: ./ClientApp/components/shared/appBootstrap.ts
var appBootstrap = __webpack_require__("QBAw");

// EXTERNAL MODULE: ./ClientApp/components/shared/Layout.tsx + 1 modules
var Layout = __webpack_require__("Xvn6");

// EXTERNAL MODULE: ./ClientApp/constants/constants.ts
var constants = __webpack_require__("m7Oc");

// EXTERNAL MODULE: ./ClientApp/contexts/AccountContext.ts
var AccountContext = __webpack_require__("KZE4");

// EXTERNAL MODULE: ./ClientApp/services/AccountService.ts + 1 modules
var AccountService = __webpack_require__("f5VE");

// EXTERNAL MODULE: ./ClientApp/services/StoreService.ts + 2 modules
var StoreService = __webpack_require__("GAEF");

// EXTERNAL MODULE: ./node_modules/react-bootstrap/es/Modal.js + 17 modules
var Modal = __webpack_require__("frVR");

// CONCATENATED MODULE: ./ClientApp/components/store/StoreItemBuyModal.tsx


class StoreItemBuyModal_StoreItemBuyModal extends react["Component"] {
    constructor(props) {
        super(props);
    }
    onHide() {
        if (this.props.onHide) {
            this.props.onHide();
        }
    }
    onPurchase() {
        if (this.props.onPurchase) {
            this.props.onPurchase(this.props.storeItem);
        }
    }
    render() {
        if (!this.props.storeItem)
            return null;
        return (react_default.a.createElement(Modal["a" /* default */], Object.assign({}, this.props, { centered: true }),
            react_default.a.createElement(Modal["a" /* default */].Header, { closeButton: true },
                react_default.a.createElement(Modal["a" /* default */].Title, null, "Purchase item")),
            react_default.a.createElement(Modal["a" /* default */].Body, null,
                react_default.a.createElement("div", { className: "row" },
                    react_default.a.createElement("div", { className: "container" },
                        "Buy ",
                        react_default.a.createElement("strong", null, this.props.storeItem.name),
                        "?"))),
            react_default.a.createElement(Modal["a" /* default */].Footer, null,
                react_default.a.createElement("button", { type: "button", className: "btn btn-secondary", onClick: () => this.onHide() }, "Cancel"),
                react_default.a.createElement("button", { type: "button", className: "btn btn-success", onClick: () => this.onPurchase() }, "Purchase"))));
    }
}

// EXTERNAL MODULE: ./ClientApp/components/shared/CoinFormat.tsx
var CoinFormat = __webpack_require__("hdYD");

// EXTERNAL MODULE: ./ClientApp/components/shared/DateFormat.tsx + 1 modules
var DateFormat = __webpack_require__("PaiT");

// CONCATENATED MODULE: ./ClientApp/components/store/StoreItemDetails.tsx



function StoreItemDetails(props) {
    const si = props.storeItem;
    const onSelectItem = () => {
        if (props.onSelectItem) {
            props.onSelectItem(si);
        }
    };
    return (react_default.a.createElement("div", { className: "card" },
        react_default.a.createElement("h4", { className: "card-header" },
            react_default.a.createElement("span", null, si.name),
            react_default.a.createElement("span", { className: "pull-right badge-pill badge-secondary" }, si.itemCount)),
        react_default.a.createElement("div", { className: "card-body" },
            react_default.a.createElement("p", null, si.description)),
        react_default.a.createElement("div", { className: "card-footer" },
            si.expiry &&
                (react_default.a.createElement(react["Fragment"], null,
                    react_default.a.createElement("span", null, "Expires "),
                    react_default.a.createElement(DateFormat["a" /* default */], { date: si.expiry }))),
            react_default.a.createElement("button", { type: "button", className: "btn btn-primary pull-right", onClick: onSelectItem },
                "Buy for ",
                react_default.a.createElement(CoinFormat["a" /* default */], { coins: si.cost, title: si.cost.toString(), stripEmpty: true })))));
}

// CONCATENATED MODULE: ./ClientApp/components/store/Store.tsx







class Store_Store extends react["Component"] {
    constructor(props) {
        super(props);
        this.state = {
            items: [],
            modalShown: false
        };
    }
    async componentDidMount() {
        const items = await StoreService["a" /* default */].getStoreItems();
        this.setState({
            items: items
        });
    }
    onModalHide() {
        this.setState({
            modalShown: false
        });
    }
    onSelectItem(item) {
        if (constants["a" /* default */].Debug) {
            console.log(item);
        }
        this.setState({
            selectedItem: item,
            modalShown: true
        });
    }
    async onPurchase(item) {
        const items = await StoreService["a" /* default */].buyCardBundle(item.id);
        if (constants["a" /* default */].Debug) {
            console.log(items);
        }
        this.setState({
            modalShown: false
        });
        const user = await AccountService["a" /* default */].getAccount();
        if (user) {
            this.context.setUser(user);
        }
        alert('Purchased bundle ' + item.name);
    }
    render() {
        return (react_default.a.createElement(react["Fragment"], null,
            react_default.a.createElement("div", { className: "row" }, this.state.items.map(x => react_default.a.createElement("div", { key: x.id, className: "col-lg-4" },
                react_default.a.createElement(StoreItemDetails, { storeItem: x, onSelectItem: (item) => this.onSelectItem(item) })))),
            react_default.a.createElement(StoreItemBuyModal_StoreItemBuyModal, { show: this.state.modalShown, onHide: () => this.onModalHide(), onPurchase: (item) => this.onPurchase(item), storeItem: this.state.selectedItem })));
    }
}
Store_Store.contextType = AccountContext["a" /* AccountContext */];

// CONCATENATED MODULE: ./ClientApp/components/store/StoreApp.tsx



class StoreApp_StoreApp extends react["Component"] {
    constructor(props) {
        super(props);
    }
    render() {
        return (react_default.a.createElement(Layout["a" /* default */], null,
            react_default.a.createElement(Store_Store, null)));
    }
}

// CONCATENATED MODULE: ./ClientApp/components/store/index.tsx




react_dom_default.a.render(react_default.a.createElement(StoreApp_StoreApp, null), appBootstrap["a" /* default */].rootElement);


/***/ })

},[["gNsK",0,1]]]);